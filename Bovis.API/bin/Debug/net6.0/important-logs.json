
{"Timestamp":"2024-02-06T19:18:02.3159289-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.Search (Bovis.API). Sequence 'value(Bovis.Common.Model.ConnectionDB).GetTable().GroupJoin(value(Bovis.Common.Model.ConnectionDB).GetTable(), a => a.Id, b => b.IdFactura, (a, factNC) => new <>f__AnonymousType51`2(a = a, factNC = factNC)).SelectMany(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.factNC.DefaultIfEmpty(), (<>h__TransparentIdentifier0, ab) => new <>f__AnonymousType52`2(<>h__TransparentIdentifier0 = <>h__TransparentIdentifier0, ab = ab)).GroupJoin(value(Bovis.Common.Model.ConnectionDB).GetTable(), <>h__TransparentIdentifier1 => <>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Id, c => c.IdFactura, (<>h__TransparentIdentifier1, factC) => new <>f__AnonymousType53`2(<>h__TransparentIdentifier1 = <>h__TransparentIdentifier1, factC = factC)).SelectMany(<>h__TransparentIdentifier2 => <>h__TransparentIdentifier2.factC.DefaultIfEmpty(), (<>h__TransparentIdentifier2, ac) => new <>f__AnonymousType54`2(<>h__TransparentIdentifier2 = <>h__TransparentIdentifier2, ac = ac)).GroupJoin(value(Bovis.Common.Model.ConnectionDB).GetTable(), <>h__TransparentIdentifier3 => <>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto, c => c.NumProyecto, (<>h__TransparentIdentifier3, cJoin) => new <>f__AnonymousType55`2(<>h__TransparentIdentifier3 = <>h__TransparentIdentifier3, cJoin = cJoin)).SelectMany(<>h__TransparentIdentifier4 => <>h__TransparentIdentifier4.cJoin.DefaultIfEmpty(), (<>h__TransparentIdentifier4, cItem) => new <>f__AnonymousType56`2(<>h__TransparentIdentifier4 = <>h__TransparentIdentifier4, cItem = cItem)).GroupJoin(value(Bovis.Common.Model.ConnectionDB).GetTable(), <>h__TransparentIdentifier5 => Convert(<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto, Nullable`1), cp => cp.NumProyecto, (<>h__TransparentIdentifier5, cpJoin) => new <>f__AnonymousType157`2(<>h__TransparentIdentifier5 = <>h__TransparentIdentifier5, cpJoin = cpJoin)).SelectMany(<>h__TransparentIdentifier6 => <>h__TransparentIdentifier6.cpJoin.DefaultIfEmpty(), (<>h__TransparentIdentifier6, cpItem) => new <>f__AnonymousType158`2(<>h__TransparentIdentifier6 = <>h__TransparentIdentifier6, cpItem = cpItem)).GroupJoin(value(Bovis.Common.Model.ConnectionDB).GetTable(), <>h__TransparentIdentifier7 => <>h__TransparentIdentifier7.cpItem.IdCliente, d => Convert(d.IdCliente, Nullable`1), (<>h__TransparentIdentifier7, dJoin) => new <>f__AnonymousType159`2(<>h__TransparentIdentifier7 = <>h__TransparentIdentifier7, dJoin = dJoin)).SelectMany(<>h__TransparentIdentifier8 => <>h__TransparentIdentifier8.dJoin.DefaultIfEmpty(), (<>h__TransparentIdentifier8, dItem) => new <>f__AnonymousType160`2(<>h__TransparentIdentifier8 = <>h__TransparentIdentifier8, dItem = dItem)).Where(<>h__TransparentIdentifier9 => (((((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.idProyecto == null) OrElse (Convert(<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto, Nullable`1) == value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.idProyecto)) AndAlso ((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).lstProyectosCliente == null) OrElse value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).lstProyectosCliente.Contains(<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto))) AndAlso (((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).lstProyectosEmpresa == null) OrElse value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).lstProyectosEmpresa.Contains(<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto)) AndAlso ((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.fechaIni == null) OrElse (Convert(<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaEmision, Nullable`1) >= value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.fechaIni)))) AndAlso (((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.fechaFin == null) OrElse (Convert(<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaEmision, Nullable`1) <= value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.fechaFin)) AndAlso ((value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.noFactura == null) OrElse (<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NoFactura == value(Bovis.Data.FacturaData+<>c__DisplayClass17_1).CS$<>8__locals1.noFactura))))).OrderByDescending(<>h__TransparentIdentifier9 => <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Id).Select(<>h__TransparentIdentifier9 => new FacturaDetalles() {Id = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Id, Uuid = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Uuid, NumProyecto = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NumProyecto, Cliente = (<>h__TransparentIdentifier9.dItem.Cliente ?? String.Empty), ClienteRFC = (<>h__TransparentIdentifier9.dItem.Rfc ?? String.Empty), IdTipoFactura = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.IdTipoFactura, IdMoneda = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.IdMoneda, Importe = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Importe, Iva = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Iva, IvaRet = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.IvaRet, Total = IIF((<>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaCancelacion == null), <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Total, Convert(Convert(0, Decimal), Nullable`1)), Concepto = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Concepto, Mes = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Mes, Anio = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.Anio, FechaEmision = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaEmision, FechaCancelacion = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaCancelacion, FechaPago = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.FechaPago, NoFactura = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.NoFactura, TipoCambio = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.TipoCambio, MotivoCancelacion = <>h__TransparentIdentifier9.<>h__TransparentIdentifier8.<>h__TransparentIdentifier7.<>h__TransparentIdentifier6.<>h__TransparentIdentifier5.<>h__TransparentIdentifier4.<>h__TransparentIdentifier3.<>h__TransparentIdentifier2.<>h__TransparentIdentifier1.<>h__TransparentIdentifier0.a.MotivoCancelacion}).DistinctBy(x => x.Id)' cannot be converted to SQL.. Stack Trace:    at LinqToDB.Linq.Builder.ExpressionBuilder.BuildSequence(BuildInfo buildInfo)\r\n   at LinqToDB.Linq.Builder.ExpressionBuilder.Build[T]()\r\n   at LinqToDB.Linq.Query`1.CreateQuery(ExpressionTreeOptimizationContext optimizationContext, ParametersContext parametersContext, IDataContext dataContext, Expression expr)\r\n   at LinqToDB.Linq.Query`1.GetQuery(IDataContext dataContext, Expression& expr, Boolean& dependsOnParameters)\r\n   at LinqToDB.Linq.ExpressionQuery`1.GetQuery(Expression& expression, Boolean cache, Boolean& dependsOnParameters)\r\n   at LinqToDB.Linq.ExpressionQuery`1.GetForEachAsync(Action`1 action, CancellationToken cancellationToken)\r\n   at LinqToDB.AsyncExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.GetAllFacturas(Nullable`1 idProyecto, Nullable`1 idCliente, Nullable`1 idEmpresa, Nullable`1 fechaIni, Nullable`1 fechaFin, String noFactura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 419\r\n   at Bovis.Business.FacturaBusiness.Search(Nullable`1 idProyecto, Nullable`1 idCliente, Nullable`1 idEmpresa, Nullable`1 fechaIni, Nullable`1 fechaFin, String noFactura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 409\r\n   at Bovis.Service.Queries.FacturaQueryService.Search(ConsultarFactura request) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.Queries\\FacturaQueryService.cs:line 65\r\n   at Bovis.API.Controllers.FacturaController.Search(ConsultarFactura request) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 140\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"cc113e01-ff3d-4f6e-af90-4abe49b1bf6e","ActionName":"Bovis.API.Controllers.FacturaController.Search (Bovis.API)","RequestId":"0HN17FAE0OTHB:00000002","RequestPath":"/api/Factura/Consultar","ConnectionId":"0HN17FAE0OTHB"}}
{"Timestamp":"2024-02-06T19:23:05.2981174-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.Search (Bovis.API). You should explicitly specify selected fields for server-side GroupBy() call or add AsEnumerable() call before GroupBy() to perform client-side grouping.\nSet Configuration.Linq.GuardGrouping = false to disable this check.\nAdditionally this guard exception can be disabled by extension GroupBy(...).DisableGuard().\nNOTE! By disabling this guard you accept additional Database Connection(s) to the server for processing such requests.. Stack Trace:    at LinqToDB.Linq.Builder.GroupByBuilder.GroupByContext.GroupByHelper`3.GetGrouping(GroupByContext context)\r\n   at LinqToDB.Linq.Builder.GroupByBuilder.GroupByContext.BuildGrouping()\r\n   at LinqToDB.Linq.Builder.SelectContext.ProcessScalar[T,TContext](TContext context, Expression expression, Int32 level, Func`5 action, Func`2 defaultAction, Boolean throwOnError)\r\n   at LinqToDB.Linq.Builder.SelectContext.BuildExpression(Expression expression, Int32 level, Boolean enforceServerSide)\r\n   at LinqToDB.Linq.Builder.ExpressionBuilder.<>c.<BuildExpression>b__94_0(ValueTuple`4 context, Expression expr)\r\n   at LinqToDB.Expressions.TransformInfoVisitor`1.Transform(Expression expr)\r\n   at LinqToDB.Expressions.TransformInfoVisitor`1.Transform[T](IList`1 source)\r\n   at LinqToDB.Expressions.TransformInfoVisitor`1.Transform(Expression expr)\r\n   at LinqToDB.Linq.Builder.ExpressionBuilder.BuildExpression(IBuildContext context, Expression expression, Boolean enforceServerSide, String alias)\r\n   at LinqToDB.Linq.Builder.SelectContext.BuildExpression(Expression expression, Int32 level, Boolean enforceServerSide)\r\n   at LinqToDB.Linq.Builder.SelectContext.BuildQuery[T](Query`1 query, ParameterExpression queryParameter)\r\n   at LinqToDB.Linq.Builder.ExpressionBuilder.Build[T]()\r\n   at LinqToDB.Linq.Query`1.CreateQuery(ExpressionTreeOptimizationContext optimizationContext, ParametersContext parametersContext, IDataContext dataContext, Expression expr)\r\n   at LinqToDB.Linq.Query`1.GetQuery(IDataContext dataContext, Expression& expr, Boolean& dependsOnParameters)\r\n   at LinqToDB.Linq.ExpressionQuery`1.GetQuery(Expression& expression, Boolean cache, Boolean& dependsOnParameters)\r\n   at LinqToDB.Linq.ExpressionQuery`1.GetForEachAsync(Action`1 action, CancellationToken cancellationToken)\r\n   at LinqToDB.AsyncExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.GetAllFacturas(Nullable`1 idProyecto, Nullable`1 idCliente, Nullable`1 idEmpresa, Nullable`1 fechaIni, Nullable`1 fechaFin, String noFactura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 419\r\n   at Bovis.Business.FacturaBusiness.Search(Nullable`1 idProyecto, Nullable`1 idCliente, Nullable`1 idEmpresa, Nullable`1 fechaIni, Nullable`1 fechaFin, String noFactura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 409\r\n   at Bovis.Service.Queries.FacturaQueryService.Search(ConsultarFactura request) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.Queries\\FacturaQueryService.cs:line 65\r\n   at Bovis.API.Controllers.FacturaController.Search(ConsultarFactura request) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 140\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"37ebd867-819b-407a-a411-b857ff8d2a8c","ActionName":"Bovis.API.Controllers.FacturaController.Search (Bovis.API)","RequestId":"0HN17FD827BTU:00000002","RequestPath":"/api/Factura/Consultar","ConnectionId":"0HN17FD827BTU"}}
{"Timestamp":"2024-02-20T20:02:11.8617348-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Unable to cast object of type 'System.Int32' to type 'System.Int16'.. Stack Trace:    at lambda_method289(Closure , Expression , IDataContext , Object[] )\r\n   at LinqToDB.Linq.QueryRunner.SetParameters(Query query, Expression expression, IDataContext parametersContext, Object[] parameters, Int32 queryNumber, SqlParameterValues parameterValues)\r\n   at LinqToDB.Linq.QueryRunnerBase.SetCommand(Boolean forGetSqlText)\r\n   at LinqToDB.Data.DataConnection.QueryRunner.ExecuteNonQueryAsync(CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.ExpressionQuery`1.LinqToDB.Async.IQueryProviderAsync.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)\r\n   at LinqToDB.LinqExtensions.InsertAsync[T](IValueInsertable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 353\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"b44258aa-edc0-4a23-a80a-69fa19384708","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG2O3JHHU:00000004","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG2O3JHHU"}}
{"Timestamp":"2024-02-20T20:03:56.2235313-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Unable to cast object of type 'System.Int32' to type 'System.Int16'.. Stack Trace:    at lambda_method289(Closure , Expression , IDataContext , Object[] )\r\n   at LinqToDB.Linq.QueryRunner.SetParameters(Query query, Expression expression, IDataContext parametersContext, Object[] parameters, Int32 queryNumber, SqlParameterValues parameterValues)\r\n   at LinqToDB.Linq.QueryRunnerBase.SetCommand(Boolean forGetSqlText)\r\n   at LinqToDB.Data.DataConnection.QueryRunner.ExecuteNonQueryAsync(CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.ExpressionQuery`1.LinqToDB.Async.IQueryProviderAsync.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)\r\n   at LinqToDB.LinqExtensions.InsertAsync[T](IValueInsertable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 353\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"b44258aa-edc0-4a23-a80a-69fa19384708","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG2O3JHHU:00000005","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG2O3JHHU"}}
{"Timestamp":"2024-02-20T20:04:40.7388712-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Unable to cast object of type 'System.Int32' to type 'System.Int16'.. Stack Trace:    at lambda_method289(Closure , Expression , IDataContext , Object[] )\r\n   at LinqToDB.Linq.QueryRunner.SetParameters(Query query, Expression expression, IDataContext parametersContext, Object[] parameters, Int32 queryNumber, SqlParameterValues parameterValues)\r\n   at LinqToDB.Linq.QueryRunnerBase.SetCommand(Boolean forGetSqlText)\r\n   at LinqToDB.Data.DataConnection.QueryRunner.ExecuteNonQueryAsync(CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.ExpressionQuery`1.LinqToDB.Async.IQueryProviderAsync.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)\r\n   at LinqToDB.LinqExtensions.InsertAsync[T](IValueInsertable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 353\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()\r\n--- End of stack trace from previous location ---\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"b44258aa-edc0-4a23-a80a-69fa19384708","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG2O3JHHU:00000006","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG2O3JHHU"}}
{"Timestamp":"2024-02-20T20:07:24.5907794-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Nullable object must have a value.. Stack Trace:    at System.Nullable`1.get_Value()\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 358\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"d4fba376-9900-4950-8ad5-2ec412292bc1","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG72G5PE7:00000002","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG72G5PE7"}}
{"Timestamp":"2024-02-20T20:08:03.3645428-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Nullable object must have a value.. Stack Trace:    at System.Nullable`1.get_Value()\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 358\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"d4fba376-9900-4950-8ad5-2ec412292bc1","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG72G5PE7:00000003","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG72G5PE7"}}
{"Timestamp":"2024-02-20T20:11:37.7774710-06:00","Level":"Error","MessageTemplate":"GlobalExceptionFilter: Error in Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API). Unable to cast object of type 'System.Int32' to type 'System.Int16'.. Stack Trace:    at lambda_method153(Closure , Expression , IDataContext , Object[] )\r\n   at LinqToDB.Linq.QueryRunner.SetParameters(Query query, Expression expression, IDataContext parametersContext, Object[] parameters, Int32 queryNumber, SqlParameterValues parameterValues)\r\n   at LinqToDB.Linq.QueryRunnerBase.SetCommand(Boolean forGetSqlText)\r\n   at LinqToDB.Data.DataConnection.QueryRunner.ExecuteNonQueryAsync(CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.QueryRunner.NonQueryQueryAsync(Query query, IDataContext dataContext, Expression expression, Object[] ps, Object[] preambles, CancellationToken cancellationToken)\r\n   at LinqToDB.Linq.ExpressionQuery`1.LinqToDB.Async.IQueryProviderAsync.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)\r\n   at LinqToDB.LinqExtensions.InsertAsync[T](IValueInsertable`1 source, CancellationToken token)\r\n   at Bovis.Data.FacturaData.CancelFactura(TB_ProyectoFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Data\\FacturaData.cs:line 360\r\n   at Bovis.Business.FacturaBusiness.CancelFactura(InsertMovApi MovAPI, CancelarFactura factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Business\\FacturaBusiness.cs:line 382\r\n   at Bovis.Service.EventHandlers.CancelFacturaEventHandler.Handle(CancelFacturaCommand request, CancellationToken cancellationToken) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.Service.EventHandlers\\FacturaEventHandler.cs:line 102\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)\r\n   at Bovis.API.Controllers.FacturaController.CancelFactura(CancelFacturaCommand factura) in E:\\DESARROLLO\\LP SOLUTIONS\\Pendientes\\Hunkabann\\BOVIS\\Code\\Bovis-api\\Bovis.API\\Controllers\\FacturaController.cs:line 116\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)\r\n   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)","Properties":{"SourceContext":"Bovis.API.Helper.GlobalExceptionFilter","ActionId":"1accb17f-984d-430d-a739-c8a4ef9bce39","ActionName":"Bovis.API.Controllers.FacturaController.CancelFactura (Bovis.API)","RequestId":"0HN1IG9G3PLAK:00000002","RequestPath":"/api/Factura/Cancelar","ConnectionId":"0HN1IG9G3PLAK"}}
